\documentclass{exam}

\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage[francais]{babel}
\usepackage{listings}

\title{TP1 : Résolution numérique de $f(x) = 0$}

\begin{document}
\maketitle

\begin{questions}

\question
Programme \texttt{values.c} : création d'une fonction simple et écriture de ses valeurs dans un fichier texte.
\begin{parts}
\part
dessiner sur papier la fonction $f(x) = x^3 - 3x + 1$ et localiser approximativement ses zéros.
\part
Dans \texttt{values.c}, écrire une fonction \texttt{f} prenant en argument $x$, de type \texttt{double}, et renvoyant  $x^3 - 3x + 1$. 
\part
Ecrire une fonction \texttt{write\_values} prenant en arguments \texttt{a, b, h}, de type \texttt{double}, et qui écrit dans un fichier nommé \texttt{values.txt} les couples $x, f(x)$ - un couple par ligne -, pour $x$ variant sur $[a, b]$ avec un pas de $h$.
\part
Ecrire une fonction \texttt{main} prenant en arguments \texttt{a, b, h} (ces arguments seront passés en ligne de commande au moment de l'exécution du programme); la fonction \texttt{main} fera ensuite appel à \texttt{write\_values} avec les arguments \texttt{a, b, h}.
\part
En ligne de commande, compiler \texttt{values.c} sous la forme \texttt{gcc values.c -o values}, vérifier que le fichier exécutable \texttt{values} est créé, puis exécuter \texttt{./values a b h}, avec $a, b, h$ des valeurs au choix; vérifier la création du fichier \texttt{values.txt}.
\part
Examiner le contenu du fichier \texttt{values.txt} et donner des encadrements des zéros de $f$ à la précision $h=0.1$.
\end{parts}


\question
Programme \texttt{newton.c} : {\bf méthode de Newton}.
\begin{parts}
\part
Soit $f$ une fonction quelconque et $x_0$ un réel, appelé valeur initiale; soit $T$ la tangente à la courbe représentative de $f$, au point $(x_0, f(x_0))$; $T$ coupe l'axe des $x$ au point d'abscisse $x_1$; exprimer $x_1$ à l'aide des quantités $x_0, f(x_0), f'(x_0)$.
\part
Illustrer la construction ci-dessus sur un dessin avec $f(x) = x^3 - 3x + 1$ et $x_0 = 2.0$; que vaut $x_1$ ?
\part
La méthode de Newton consiste à prendre $x_1$ comme nouvelle valeur initiale, et à répéter le processus ci-dessus; on obtient ainsi des valeurs $x_2, x_3, \cdots$, etc; sur le dessin précédent, vers quoi semble converger la suite $x_n$ ?
\part
Dans \texttt{newton.c}, écrire la fonction \texttt{f} habituelle, puis écrire la fonction \texttt{df} représentant la dérivée de $f$.
\part
Ecrire une fonction \texttt{newton} qui prend en arguments  \texttt{x0, epsilon}, de type \texttt{double} et qui écrit dans un fichier nommé \texttt{newton.txt} les couples $x_n, \lvert x_n - x_{n-1} \rvert$ - un couple par ligne - (la quantité $\lvert x_n - x_{n-1} \rvert$ s'appelle erreur de la méthode de Newton à l'étape $n$). Condition d'arrêt : $\lvert x_n - x_{n-1} \rvert < \epsilon$; la première ligne, correspondant à $n = 0$, ne contiendra que la valeur $x_0$.
\part
Compiler \texttt{gcc newton.c -o newton}, exécuter \texttt{./newton x0 epsilon} pour différentes valeurs de \texttt{x0 epsilon} et vérifier vos résultats dans le fichier \texttt{newton.txt}.
\end{parts}

\question
Programme \texttt{newton\_numdiff.c} : méthode de Newton avec {\bf dérivée numérique}.\\
Pour éviter le calcul à la main de la dérivée de $f$, qui peut s'avérer difficile, voire impossible, on peut utiliser l'approximation mathématique 
\begin{equation}
\label{numdiff}
f'(x) \approx \frac{f(x+h) - f(x-h)}{2h}
\end{equation}
 où $h$ est un réel positif fixé.
\begin{parts}
\part
Sauvegarder le programme \texttt{newton.c} dans un fichier \texttt{newton\_numdiff.c}
\part
Dans \texttt{newton\_numdiff.c}, supprimer la fonction \texttt{df} et ajouter la constante \texttt{h = 1.0E-8}.
\part
Modifier la fonction \texttt{newton} en accord avec l'approximation (\ref{numdiff}); les résultats du calcul seront écrits dans un fichier \texttt{newton\_numdiff.txt}.

\part
Compiler et exécuter \texttt{newton\_numdiff} et comparer les résultats avec ceux de \texttt{newton}.
\end{parts}

\question
Programme \texttt{secante.c} : {\bf méthode de la sécante}.
\begin{parts}
\part
Soit $f$ une fonction et $x_0, x_1$ deux réels distincts - les valeurs initiales; soit $T$ la droite - appelée sécante - s'appuyant sur les points $(x_0, f(x_0))$ et $(x_1, f(x_1))$; $T$ coupe l'axe des $x$ au point d'abscisse $x_2$; exprimer $x_2$ à l'aide des quantités $x_0, f(x_0), x_1, f(x_1)$.
\part
Illustrer cette construction avec $f(x) = x^3 - 3x + 1$ et $x_0 = 1.0, x_1 = 2$; que vaut $x_2$ ?
\part
La méthode de la sécante consiste à prendre $x_1, x_2$ comme nouvelles valeurs initiales, et à répéter le processus; on obtient ainsi des valeurs $x_2, x_3, \cdots$, etc; sur le dessin précédent, vers quoi semble converger la suite $x_n$ ?
\part
Dans \texttt{secante.c}, outre la fonction \texttt{f}, écrire une fonction \texttt{secante} qui prend en arguments  \texttt{x0, x1, epsilon} et qui écrit dans un fichier \texttt{secante.txt} les couples $x_n, \lvert x_n - x_{n-1} \rvert$ - un couple par ligne -. Condition d'arrêt : $\lvert x_n - x_{n-1} \rvert < \epsilon$.
\part
Compiler \texttt{gcc secante.c -o secante}, exécuter \texttt{./secante x0 x1 epsilon} pour différentes valeurs \texttt{x0 x1 epsilon} et vérifier vos résultats dans \texttt{secante.txt}.
\end{parts}


\question
Programme \texttt{dichotomie.c} : la {\bf méthode de dichotomie} suppose que $f$ est continue sur un intervalle $(a, b)$ et change de signe sur l'intervalle; on est donc assuré que $f$ possède un zéro sur cet intervalle. Ensuite on coupe l'intervalle $(a, b)$ en deux et on garde celui des deux intervalles où $f$ change de signe. On obtient donc un nouvel encadrement $(a, b)$ deux fois plus petit. On répète l'opération jusqu'à obtenir la précision souhaitée.
\begin{parts}
\part
Ecrire une fonction \texttt{dichotomie} qui prend en arguments \texttt{a, b, epsilon} de type \texttt{double} et qui écrit dans un fichier \texttt{dichotomie.txt} les encadrements successifs $(a, b)$ - un couple par ligne; condition d'arrêt : $\lvert b - a \rvert < \epsilon$.
\part
Compiler \texttt{gcc dichotomie.c -o dichotomie}; exécuter \texttt{./dichotomie a b epsilon} pour différentes valeurs de \texttt{a b epsilon} et vérifier vos résultats dans le fichier \texttt{dichotomie.txt}.
\end{parts}


\question
\begin{parts}
\part
Pour chacune des méthodes présentées, faire varier la valeur de $\epsilon$ et compter le nombre d'itérations effectuées; reporter les résultats dans le tableau :
\begin{center}
\begin{tabular}{r | c c c c c}
{$\epsilon$} & $10^{-3}$ & $10^{-6}$ & $10^{-9}$ & $10^{-12}$ & $10^{-15}$ \\
\hline
\texttt{newton} & {} & {} & {} & {} & {} \\
\texttt{sécante} & {} & {} & {} & {} & {} \\
\texttt{dichotomie} & {} & {} & {} & {} & {} 
\end{tabular}
\end{center}
\part
Rédiger un court compte-rendu, contenant explications, commentaires, dessins, table.
\end{parts}
\end{questions}

\end{document}



